<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Musical Vibe Quiz</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div id="step-1">
        <h1>Music Quiz</h1>
        <p><strong>> ESCOLHA 3 ESTILOS:</strong></p>
        <div class="grid" id="grid-estilos"></div>
        <button id="btn-ir-resultado" class="action-btn" disabled onclick="gerarCidade()">CALCULAR (0/3)</button>
    </div>

    <div id="step-2" class="hidden">
        <h1>DESTINO:</h1>
        <div id="cidade-nome" style="font-size: 1.8rem; font-weight: 900; margin: 10px 0; text-transform: uppercase;">CIDADE</div>
        <div class="city-img-container" onclick="createSparks(event)">
            <img id="img-cidade" src="" alt="Resultado">
        </div>
        <p id="cidade-desc" style="font-weight: bold; margin-bottom: 20px;"></p>
        <button class="action-btn" style="background:#ffff00; color:#000;" onclick="abrirIndicao()">INDICAÇÃO DE MÚSICA?</button>
    </div>

    <div id="step-3" class="hidden">
        <h1>INDICAÇÃO</h1>
        <p><strong>> ESCOLHA 1 ESTILO:</strong></p>
        <div class="grid" id="grid-unico"></div>
    </div>

    <div id="step-4" class="hidden">
        <h1>OUÇA ISSO:</h1>
        <div id="box-final" class="recommendation-box">
            <h2 id="musica-final" style="margin:0; text-transform: uppercase;"></h2>
            <p id="artista-final" style="margin:10px 0 0 0; font-weight: bold;"></p>
        </div>
        <button class="action-btn" style="background:#fff; color:#000; margin-top:20px;" onclick="location.reload()">RECOMEÇAR</button>
    </div>
</div>

<script>
    const estilos = [
        { nome: "Sertanejo", cat: "rio", cor: "#FF8C00", musica: "Erro Gostoso", artista: "Simone Mendes" },
        { nome: "Funk", cat: "rio", cor: "#FF00FF", musica: "Boladão", artista: "MC Danado" },
        { nome: "MPB", cat: "rio", cor: "#32CD32", musica: "Avisa", artista: "Gilberto Gil" },
        { nome: "Reggae", cat: "rio", cor: "#FFD700", musica: "Is This Love", artista: "Bob Marley" },
        { nome: "Pop", cat: "ny", cor: "#00BFFF", musica: "Anti-Hero", artista: "Taylor Swift" },
        { nome: "Hip-Hop", cat: "ny", cor: "#708090", musica: "HUMBLE.", artista: "Kendrick Lamar" },
        { nome: "K-Pop", cat: "ny", cor: "#FFB6C1", musica: "Dynamite", artista: "BTS" },
        { nome: "Rock", cat: "londres", cor: "#FF0000", musica: "Do I Wanna Know?", artista: "Arctic Monkeys" },
        { nome: "Jazz", cat: "londres", cor: "#4B0082", musica: "Back to Black", artista: "Amy Winehouse" },
        { nome: "Eletrônica", cat: "berlim", cor: "#ADFF2F", musica: "Animals", artista: "Martin Garrix" }
    ];

    const cidades = {
        rio: { 
            nome: "RIO DE JANEIRO", 
            desc: "Vibe solar e maravilhosa!", 
            img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcScs3RfBZzBa15XrsBJFv-Y65vIb687K4f4tQ&s" 
        },
        ny: { 
            nome: "NEW YORK", 
            desc: "A cidade que nunca dorme!", 
            img: "https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9?w=800" 
        },
        londres: { 
            nome: "LONDRES", 
            desc: "Elegância e rock n' roll!", 
            img: "https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=800" 
        },
        berlim: { 
            nome: "BERLIM", 
            desc: "A capital mundial da techno!", 
            img: "https://images.unsplash.com/photo-1560969184-10fe8719e047?w=800" 
        }
    };

    let selecionados3 = [];

    const grid1 = document.getElementById('grid-estilos');
    estilos.forEach(estilo => {
        const div = document.createElement('div');
        div.className = 'btn';
        div.innerText = estilo.nome;
        div.onclick = () => {
            if (selecionados3.includes(estilo)) {
                selecionados3 = selecionados3.filter(s => s !== estilo);
                div.classList.remove('active');
                div.style.backgroundColor = "#fff";
            } else if (selecionados3.length < 3) {
                selecionados3.push(estilo);
                div.classList.add('active');
                div.style.backgroundColor = estilo.cor;
            }
            document.getElementById('btn-ir-resultado').disabled = selecionados3.length !== 3;
            document.getElementById('btn-ir-resultado').innerText = `CALCULAR (${selecionados3.length}/3)`;
        };
        grid1.appendChild(div);
    });

    function gerarCidade() {
        let pontos = { rio: 0, ny: 0, londres: 0, berlim: 0 };
        selecionados3.forEach(s => pontos[s.cat]++);
        let vencedor = Object.keys(pontos).reduce((a, b) => pontos[a] >= pontos[b] ? a : b);
        const dados = cidades[vencedor];
        document.getElementById('step-1').classList.add('hidden');
        document.getElementById('step-2').classList.remove('hidden');
        document.getElementById('cidade-nome').innerText = dados.nome;
        document.getElementById('cidade-desc').innerText = dados.desc;
        document.getElementById('img-cidade').src = dados.img;
    }

    function abrirIndicao() {
        document.getElementById('step-2').classList.add('hidden');
        document.getElementById('step-3').classList.remove('hidden');
        const gridUnico = document.getElementById('grid-unico');
        gridUnico.innerHTML = '';
        estilos.forEach(estilo => {
            const div = document.createElement('div');
            div.className = 'btn';
            div.innerText = estilo.nome;
            div.onmouseover = () => div.style.backgroundColor = estilo.cor;
            div.onmouseout = () => div.style.backgroundColor = "#fff";
            div.onclick = () => {
                document.getElementById('step-3').classList.add('hidden');
                document.getElementById('step-4').classList.remove('hidden');
                document.getElementById('box-final').style.backgroundColor = estilo.cor;
                document.getElementById('musica-final').innerText = `"${estilo.musica}"`;
                document.getElementById('artista-final').innerText = `ARTISTA: ${estilo.artista}`;
            };
            gridUnico.appendChild(div);
        });
    }

    const sparkColors = ['#FF00FF', '#00FFFF', '#FFFF00', '#FF0000', '#00FF00'];
    function createSparks(e) {
        const container = e.currentTarget;
        const rect = container.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        for (let i = 0; i < 15; i++) {
            const spark = document.createElement('div');
            spark.className = 'spark';
            spark.style.left = `${x}px`;
            spark.style.top = `${y}px`;
            spark.style.backgroundColor = sparkColors[Math.floor(Math.random() * sparkColors.length)];
            const angle = Math.random() * Math.PI * 2;
            const dist = 40 + Math.random() * 110;
            spark.style.setProperty('--tx', `${Math.cos(angle) * dist}px`);
            spark.style.setProperty('--ty', `${Math.sin(angle) * dist}px`);
            container.appendChild(spark);
            setTimeout(() => spark.remove(), 800);
        }
    }
</script>
</body>
</html>